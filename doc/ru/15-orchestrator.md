# Глава 15: Оркестратор

## Обзор

Оркестратор — мозг sysdiag. Запускает все коллекторы параллельно, обрабатывает сигналы, управляет таймаутами.

## 5 фаз выполнения

```
Фаза 1: Инициализация → Создание коллекторов, применение профиля
Фаза 2: Сбор           → Параллельный запуск всех коллекторов
Фаза 3: Сборка         → Категоризация результатов
Фаза 4: Анализ         → USE-метрики, аномалии, health score, рекомендации
Фаза 5: Вывод          → JSON файл или stdout
```

## Профили сбора

| Профиль | Длительность | Таймаут | BCC-инструменты |
|---------|-------------|---------|----------------|
| `quick` | 10с | 30с | нет |
| `standard` | 30с | 90с | runqlat, biolatency, tcpconnlat, tcpretrans |
| `deep` | 60с | 180с | 11 инструментов + стеки |

## Обработка сигналов

Горутина обработки сигналов запускается **после** `context.WithTimeout()` чтобы использовать финальный контекст. Это предотвращает гонку.

---

*Далее: [Глава 16 — Форматы вывода](16-output-formats.md)*
